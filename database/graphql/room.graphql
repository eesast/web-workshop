# 房间查询
query GetRoomById($uuid: uuid!) {
  room_by_pk(uuid: $uuid) {
    uuid
    name
    description
    creator
    created_at
  }
}

query GetRoomsByCreator($creator: uuid!) {
  room(where: {creator: {_eq: $creator}}) {
    uuid
    name
    description
    created_at
  }
}

query GetUserRooms($user: uuid!) {
  user_room(where: {user: {_eq: $user}}) {
    room {
      uuid
      name
      description
      created_at
    }
    joined_at
  }
}

# 房间变更
mutation CreateRoom($name: String!, $description: String, $creator: uuid!) {
  insert_room_one(object: {name: $name, description: $description, creator: $creator}) {
    uuid
    name
    description
    creator
  }
}

mutation JoinRoom($user: uuid!, $room: uuid!) {
  insert_user_room_one(object: {user: $user, room: $room}) {
    uuid
    user
    room
    joined_at
  }
}

mutation LeaveRoom($user: uuid!, $room: uuid!) {
  delete_user_room(where: {user: {_eq: $user}, room: {_eq: $room}}) {
    affected_rows
  }
}
