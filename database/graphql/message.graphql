# 消息查询
query GetMessagesByRoom($room: uuid!) {
  message(where: {room: {_eq: $room}}, order_by: {created_at: asc}) {
    uuid
    content
    sender
    created_at
    user {
      username
    }
  }
}

query GetMessagesBySender($sender: uuid!) {
  message(where: {sender: {_eq: $sender}}, order_by: {created_at: desc}) {
    uuid
    content
    room
    created_at
  }
}

# 消息变更
mutation CreateMessage($room: uuid!, $content: String!, $sender: uuid!) {
  insert_message_one(object: {room: $room, content: $content, sender: $sender}) {
    uuid
    content
    sender
    created_at
  }
}

mutation DeleteMessage($uuid: uuid!) {
  delete_message_by_pk(uuid: $uuid) {
    uuid
    content
  }
}

mutation UpdateMessage($uuid: uuid!, $content: String!) {
  update_message_by_pk(pk_columns: {uuid: $uuid}, _set: {content: $content}) {
    uuid
    content
    updated_at
  }
}
